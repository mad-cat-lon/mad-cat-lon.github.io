---
layout: default
title: Reverse engineering the Vuse vape ecosystem (pt 2)
date: 2014-07-26 00:18:23
categories: reverse-engineering
short_description: Decompilation and static analysis of the MyVuse companion app and investigating BLE traffic with device.
image_preview: https://github.com/mad-cat-lon.png
---
<div>
    <section>
    <h1> Reverse engineering the Vuse vape ecosystem (pt 2) </h1>
    </section>
    <section>
    <h2> Decompiling MyVuse </h2>
    <o>To turn the Dalvik (now called ART) bytecode back into readable Java, I used the excellent <a href="https://github.com/skylot/jadx">jadx decompiler</a>. Immediately I noticed the `com.bat` package, which clearly stands for British American Tobacco. The UI is contained in `myvuse.mobile` and is clearly using React Native. `sdk` is more interesting, as it contains the core functionality for the application, which likely includes user auth, device management through BLE, etc. </p>
    <h3> BatVocabulary </h3>
    <p>
    Located in `com.bat.sdk.devices`, the `BatVocabulary` class contains a wealth of information on the devices that MyVuse supports. For example, the Epod 2 has the following characteristics and services:
    <pre>
    <code class="language-java">
    public static final Characteristics INSTANCE = new Characteristics();
    public static final String ageChallengeCharacteristic = "6CD6C8B5-E378-0104-010D-1B9740683449";
    public static final String ageSignatureCharacteristic = "6CD6C8B5-E378-0104-020D-1B9740683449";
    public static final String batteryCharacteristic = "6CD6C8B5-E378-0104-030A-1B9740683449";
    public static final String cloudCharacteristic = "6CD6C8B5-E378-0104-0C0A-1B9740683449";
    public static final String controlCharacteristic = "6CD6C8B5-E378-0104-020C-1B9740683449";
    public static final String deviceInfoCharacteristic = "6CD6C8B5-E378-0104-010A-1B9740683449";
    public static final String errorCharacteristic = "6CD6C8B5-E378-0104-010B-1B9740683449";
    public static final String findCharacteristic = "6CD6C8B5-E378-0104-090A-1B9740683449";
    public static final String hapticCharacteristic = "6CD6C8B5-E378-0104-0D0A-1B9740683449";
    public static final String ledCharacteristic = "6CD6C8B5-E378-0104-0A0A-1B9740683449";
    public static final String lockCharacteristic = "6CD6C8B5-E378-0104-040A-1B9740683449";
    public static final String logCharacteristic = "6CD6C8B5-E378-0104-030B-1B9740683449";
    public static final String payloadChallengeCharacteristic = "6CD6C8B5-E378-0104-040C-1B9740683449";
    public static final String payloadCharacteristic = "6CD6C8B5-E378-0104-030C-1B9740683449";
    public static final String puffsCharacteristic = "6CD6C8B5-E378-0104-060A-1B9740683449";
    public static final String resetCharacteristic = "6CD6C8B5-E378-0104-0B0A-1B9740683449";
    public static final String timeCharacteristic = "6CD6C8B5-E378-0104-020A-1B9740683449";
    public static final String versionCharacteristic = "6CD6C8B5-E378-0104-010C-1B9740683449";


    public static final String ageVerificationService = "6CD6C8B5-E378-0104-000D-1B9740683449";
    public static final String deviceManagementService = "6CD6C8B5-E378-0104-000C-1B9740683449";
    public static final String logService = "6CD6C8B5-E378-0104-000B-1B9740683449";
    public static final String vapingService = "6CD6C8B5-E378-0104-000A-1B9740683449";
    </code>
    </pre>
    </p>
    </section>
</div>